{"ast":null,"code":"import { finalize } from 'rxjs/operators';\nimport { FileMetaData } from 'src/app/models/file-upload.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/services/file.service\";\nimport * as i2 from \"@angular/fire/compat/storage\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\n\nfunction FileuploadComponent_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"a\", 17);\n    i0.ɵɵlistener(\"click\", function FileuploadComponent_tr_26_Template_a_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const file_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.deleteFile(file_r2);\n    });\n    i0.ɵɵtext(7, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const file_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r2.size);\n  }\n}\n\nfunction FileuploadComponent_tr_47_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 18);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const file_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r5.name);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    width: a0\n  };\n};\n\nconst _c1 = function (a0, a1, a2, a3) {\n  return {\n    \"bg-success\": a0,\n    \"bg-info\": a1,\n    \"bg-warning\": a2,\n    \"bg-danger\": a3\n  };\n};\n\nFileMetaData;\nexport class FileuploadComponent {\n  constructor(fileService, fireStorage) {\n    this.fileService = fileService;\n    this.fireStorage = fireStorage;\n    this.percentage = 0;\n    this.listOfFiles = [];\n  }\n\n  ngOnInit() {\n    this.getAllFiles();\n  }\n\n  selectFile(event) {\n    this.selectedFiles = event.target.files;\n  }\n\n  uploadFile() {\n    this.currentFileUpload = new FileMetaData(this.selectedFiles[0]);\n    const path = 'Uploads/' + this.currentFileUpload.file.name;\n    const storageRef = this.fireStorage.ref(path);\n    const uploadTask = storageRef.put(this.selectedFiles[0]);\n    uploadTask.snapshotChanges().pipe(finalize(() => {\n      storageRef.getDownloadURL().subscribe(downloadLink => {\n        this.currentFileUpload.id = '';\n        this.currentFileUpload.url = downloadLink;\n        this.currentFileUpload.size = this.currentFileUpload.file.size;\n        this.currentFileUpload.name = this.currentFileUpload.file.name;\n        this.fileService.saveMetaDataOfFile(this.currentFileUpload);\n      });\n      this.ngOnInit();\n    })).subscribe(res => {\n      this.percentage = res.bytesTransferred * 100 / res.totalBytes;\n    }, err => {\n      console.log('Error occured');\n    });\n  }\n\n  getAllFiles() {\n    this.fileService.getAllFiles().subscribe(res => {\n      this.listOfFiles = res.map(e => {\n        const data = e.payload.doc.data();\n        data.id = e.payload.doc.id; //console.log(data);\n\n        return data;\n      });\n    }, err => {\n      console.log('Error occured while fetching file meta data');\n    });\n  }\n\n  deleteFile(file) {\n    if (window.confirm('Are you sure you want to delete ' + file.name + '?')) {\n      this.fileService.deleteFile(file);\n      this.ngOnInit();\n    }\n  }\n\n}\n\nFileuploadComponent.ɵfac = function FileuploadComponent_Factory(t) {\n  return new (t || FileuploadComponent)(i0.ɵɵdirectiveInject(i1.FileService), i0.ɵɵdirectiveInject(i2.AngularFireStorage));\n};\n\nFileuploadComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: FileuploadComponent,\n  selectors: [[\"app-fileupload\"]],\n  decls: 48,\n  vars: 14,\n  consts: [[1, \"container-fluid\"], [1, \"row\"], [1, \"col-md-4\", \"mt-5\"], [1, \"card\", \"border-0\", \"shadow\"], [1, \"card-body\"], [\"type\", \"file\", 1, \"text-nowrap\", \"text-truncate\", \"file\", 3, \"change\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-warning\", 3, \"disabled\", \"click\"], [1, \"progress\", \"mt-2\"], [\"role\", \"progressbar\", \"aria-valuemin\", \"0\", \"aria-valuemax\", \"100\", 1, \"progress-bar\", \"progress-bar-info\", 3, \"ngStyle\", \"ngClass\"], [1, \"col-md-8\"], [1, \"mb-3\", \"mt-3\"], [1, \"text-primary\"], [1, \"table\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [1, \"table\", \"table-striped\"], [\"sortable\", \"name\", \"scope\", \"col\", 3, \"sort\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-danger\", \"ms-2\", 3, \"click\"], [\"scope\", \"row\"]],\n  template: function FileuploadComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"div\")(6, \"input\", 5);\n      i0.ɵɵlistener(\"change\", function FileuploadComponent_Template_input_change_6_listener($event) {\n        return ctx.selectFile($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function FileuploadComponent_Template_button_click_7_listener() {\n        return ctx.uploadFile();\n      });\n      i0.ɵɵtext(8, \" Upload \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(9, \"div\", 7)(10, \"div\", 8);\n      i0.ɵɵtext(11);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(12, \"div\", 9)(13, \"div\", 10)(14, \"h4\", 11);\n      i0.ɵɵtext(15, \"File list\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(16, \"table\", 12)(17, \"thead\")(18, \"tr\")(19, \"th\", 13);\n      i0.ɵɵtext(20, \"File name\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(21, \"th\", 13);\n      i0.ɵɵtext(22, \"File size\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"th\", 13);\n      i0.ɵɵtext(24, \"Action\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(25, \"tbody\");\n      i0.ɵɵtemplate(26, FileuploadComponent_tr_26_Template, 8, 2, \"tr\", 14);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(27, \"p\");\n      i0.ɵɵtext(28, \" This is a more complete example with a service that simulates server calling:\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(29, \"ul\")(30, \"li\");\n      i0.ɵɵtext(31, \"an observable async service to fetch a list of countries\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"li\");\n      i0.ɵɵtext(33, \"sorting, filtering and pagination\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"li\");\n      i0.ɵɵtext(35, \"simulated delay and loading indicator\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(36, \"li\");\n      i0.ɵɵtext(37, \"debouncing of search requests\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(38, \"form\")(39, \"table\", 15)(40, \"thead\")(41, \"tr\")(42, \"th\", 13);\n      i0.ɵɵtext(43, \"#\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(44, \"th\", 16);\n      i0.ɵɵlistener(\"sort\", function FileuploadComponent_Template_th_sort_44_listener($event) {\n        return ctx.onSort($event);\n      });\n      i0.ɵɵtext(45, \"File name\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(46, \"tbody\");\n      i0.ɵɵtemplate(47, FileuploadComponent_tr_47_Template, 3, 1, \"tr\", 14);\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"disabled\", !ctx.selectedFiles);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(7, _c0, ctx.percentage + \"%\"))(\"ngClass\", i0.ɵɵpureFunction4(9, _c1, ctx.percentage > 70, ctx.percentage > 40 && ctx.percentage < 70, ctx.percentage > 20 && ctx.percentage < 40, ctx.percentage > 0 && ctx.percentage < 20));\n      i0.ɵɵattribute(\"aria-valuenow\", ctx.percentage);\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\" \", ctx.percentage, \"% \");\n      i0.ɵɵadvance(15);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listOfFiles);\n      i0.ɵɵadvance(21);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listOfFiles);\n    }\n  },\n  directives: [i3.NgStyle, i3.NgClass, i3.NgForOf, i4.ɵNgNoValidate, i4.NgControlStatusGroup],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJmaWxlLXVwbG9hZC5jb21wb25lbnQuc2NzcyJ9 */\"]\n});","map":{"version":3,"sources":["/Users/mrcll/teste-fdp/angularfirebase-authentication/src/app/components/file-upload/file-upload.component.ts"],"names":["finalize","FileMetaData","i0","i1","i2","i3","i4","FileuploadComponent_tr_26_Template","rf","ctx","_r4","ɵɵgetCurrentView","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","FileuploadComponent_tr_26_Template_a_click_6_listener","restoredCtx","ɵɵrestoreView","file_r2","$implicit","ctx_r3","ɵɵnextContext","deleteFile","ɵɵadvance","ɵɵtextInterpolate","name","size","FileuploadComponent_tr_47_Template","file_r5","_c0","a0","width","_c1","a1","a2","a3","FileuploadComponent","constructor","fileService","fireStorage","percentage","listOfFiles","ngOnInit","getAllFiles","selectFile","event","selectedFiles","target","files","uploadFile","currentFileUpload","path","file","storageRef","ref","uploadTask","put","snapshotChanges","pipe","getDownloadURL","subscribe","downloadLink","id","url","saveMetaDataOfFile","res","bytesTransferred","totalBytes","err","console","log","map","e","data","payload","doc","window","confirm","ɵfac","FileuploadComponent_Factory","t","ɵɵdirectiveInject","FileService","AngularFireStorage","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","FileuploadComponent_Template","FileuploadComponent_Template_input_change_6_listener","$event","FileuploadComponent_Template_button_click_7_listener","ɵɵtemplate","FileuploadComponent_Template_th_sort_44_listener","onSort","ɵɵproperty","ɵɵpureFunction1","ɵɵpureFunction4","ɵɵattribute","ɵɵtextInterpolate1","directives","NgStyle","NgClass","NgForOf","ɵNgNoValidate","NgControlStatusGroup","styles"],"mappings":"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","sourcesContent":["import { finalize } from 'rxjs/operators';\nimport { FileMetaData } from 'src/app/models/file-upload.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/services/file.service\";\nimport * as i2 from \"@angular/fire/compat/storage\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction FileuploadComponent_tr_26_Template(rf, ctx) { if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"a\", 17);\n    i0.ɵɵlistener(\"click\", function FileuploadComponent_tr_26_Template_a_click_6_listener() { const restoredCtx = i0.ɵɵrestoreView(_r4); const file_r2 = restoredCtx.$implicit; const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.deleteFile(file_r2); });\n    i0.ɵɵtext(7, \"Delete\");\n    i0.ɵɵelementEnd()()();\n} if (rf & 2) {\n    const file_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r2.size);\n} }\nfunction FileuploadComponent_tr_47_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 18);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n} if (rf & 2) {\n    const file_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r5.name);\n} }\nconst _c0 = function (a0) { return { width: a0 }; };\nconst _c1 = function (a0, a1, a2, a3) { return { \"bg-success\": a0, \"bg-info\": a1, \"bg-warning\": a2, \"bg-danger\": a3 }; };\nFileMetaData;\nexport class FileuploadComponent {\n    constructor(fileService, fireStorage) {\n        this.fileService = fileService;\n        this.fireStorage = fireStorage;\n        this.percentage = 0;\n        this.listOfFiles = [];\n    }\n    ngOnInit() {\n        this.getAllFiles();\n    }\n    selectFile(event) {\n        this.selectedFiles = event.target.files;\n    }\n    uploadFile() {\n        this.currentFileUpload = new FileMetaData(this.selectedFiles[0]);\n        const path = 'Uploads/' + this.currentFileUpload.file.name;\n        const storageRef = this.fireStorage.ref(path);\n        const uploadTask = storageRef.put(this.selectedFiles[0]);\n        uploadTask\n            .snapshotChanges()\n            .pipe(finalize(() => {\n            storageRef.getDownloadURL().subscribe((downloadLink) => {\n                this.currentFileUpload.id = '';\n                this.currentFileUpload.url = downloadLink;\n                this.currentFileUpload.size = this.currentFileUpload.file.size;\n                this.currentFileUpload.name = this.currentFileUpload.file.name;\n                this.fileService.saveMetaDataOfFile(this.currentFileUpload);\n            });\n            this.ngOnInit();\n        }))\n            .subscribe((res) => {\n            this.percentage = (res.bytesTransferred * 100) / res.totalBytes;\n        }, (err) => {\n            console.log('Error occured');\n        });\n    }\n    getAllFiles() {\n        this.fileService.getAllFiles().subscribe((res) => {\n            this.listOfFiles = res.map((e) => {\n                const data = e.payload.doc.data();\n                data.id = e.payload.doc.id;\n                //console.log(data);\n                return data;\n            });\n        }, (err) => {\n            console.log('Error occured while fetching file meta data');\n        });\n    }\n    deleteFile(file) {\n        if (window.confirm('Are you sure you want to delete ' + file.name + '?')) {\n            this.fileService.deleteFile(file);\n            this.ngOnInit();\n        }\n    }\n}\nFileuploadComponent.ɵfac = function FileuploadComponent_Factory(t) { return new (t || FileuploadComponent)(i0.ɵɵdirectiveInject(i1.FileService), i0.ɵɵdirectiveInject(i2.AngularFireStorage)); };\nFileuploadComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FileuploadComponent, selectors: [[\"app-fileupload\"]], decls: 48, vars: 14, consts: [[1, \"container-fluid\"], [1, \"row\"], [1, \"col-md-4\", \"mt-5\"], [1, \"card\", \"border-0\", \"shadow\"], [1, \"card-body\"], [\"type\", \"file\", 1, \"text-nowrap\", \"text-truncate\", \"file\", 3, \"change\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-warning\", 3, \"disabled\", \"click\"], [1, \"progress\", \"mt-2\"], [\"role\", \"progressbar\", \"aria-valuemin\", \"0\", \"aria-valuemax\", \"100\", 1, \"progress-bar\", \"progress-bar-info\", 3, \"ngStyle\", \"ngClass\"], [1, \"col-md-8\"], [1, \"mb-3\", \"mt-3\"], [1, \"text-primary\"], [1, \"table\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [1, \"table\", \"table-striped\"], [\"sortable\", \"name\", \"scope\", \"col\", 3, \"sort\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-danger\", \"ms-2\", 3, \"click\"], [\"scope\", \"row\"]], template: function FileuploadComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"div\")(6, \"input\", 5);\n        i0.ɵɵlistener(\"change\", function FileuploadComponent_Template_input_change_6_listener($event) { return ctx.selectFile($event); });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"button\", 6);\n        i0.ɵɵlistener(\"click\", function FileuploadComponent_Template_button_click_7_listener() { return ctx.uploadFile(); });\n        i0.ɵɵtext(8, \" Upload \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\", 7)(10, \"div\", 8);\n        i0.ɵɵtext(11);\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(12, \"div\", 9)(13, \"div\", 10)(14, \"h4\", 11);\n        i0.ɵɵtext(15, \"File list\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(16, \"table\", 12)(17, \"thead\")(18, \"tr\")(19, \"th\", 13);\n        i0.ɵɵtext(20, \"File name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"th\", 13);\n        i0.ɵɵtext(22, \"File size\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"th\", 13);\n        i0.ɵɵtext(24, \"Action\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(25, \"tbody\");\n        i0.ɵɵtemplate(26, FileuploadComponent_tr_26_Template, 8, 2, \"tr\", 14);\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(27, \"p\");\n        i0.ɵɵtext(28, \" This is a more complete example with a service that simulates server calling:\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"ul\")(30, \"li\");\n        i0.ɵɵtext(31, \"an observable async service to fetch a list of countries\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"li\");\n        i0.ɵɵtext(33, \"sorting, filtering and pagination\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"li\");\n        i0.ɵɵtext(35, \"simulated delay and loading indicator\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"li\");\n        i0.ɵɵtext(37, \"debouncing of search requests\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(38, \"form\")(39, \"table\", 15)(40, \"thead\")(41, \"tr\")(42, \"th\", 13);\n        i0.ɵɵtext(43, \"#\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"th\", 16);\n        i0.ɵɵlistener(\"sort\", function FileuploadComponent_Template_th_sort_44_listener($event) { return ctx.onSort($event); });\n        i0.ɵɵtext(45, \"File name\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(46, \"tbody\");\n        i0.ɵɵtemplate(47, FileuploadComponent_tr_47_Template, 3, 1, \"tr\", 14);\n        i0.ɵɵelementEnd()()();\n    } if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"disabled\", !ctx.selectedFiles);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(7, _c0, ctx.percentage + \"%\"))(\"ngClass\", i0.ɵɵpureFunction4(9, _c1, ctx.percentage > 70, ctx.percentage > 40 && ctx.percentage < 70, ctx.percentage > 20 && ctx.percentage < 40, ctx.percentage > 0 && ctx.percentage < 20));\n        i0.ɵɵattribute(\"aria-valuenow\", ctx.percentage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.percentage, \"% \");\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listOfFiles);\n        i0.ɵɵadvance(21);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listOfFiles);\n    } }, directives: [i3.NgStyle, i3.NgClass, i3.NgForOf, i4.ɵNgNoValidate, i4.NgControlStatusGroup], styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJmaWxlLXVwbG9hZC5jb21wb25lbnQuc2NzcyJ9 */\"] });\n"]},"metadata":{},"sourceType":"module"}